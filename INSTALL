Invenio INSTALLATION
====================

About
-----

This document specifies how to quickly install Invenio v2.0.0 for the first
time. See RELEASE-NOTES if you are upgrading from a previous Invenio release.

Prerequisites
-------------

Here is the software you need to have around before you start installing
Invenio for development.

Unix-like operating system.  The main development and production platforms for
Invenio at CERN are GNU/Linux distributions Debian, Gentoo, Scientific Linux
(aka RHEL), Ubuntu, but we also develop on Mac OS X.  Basically any Unix system
supporting the software listed below should do.

If you are using Ubuntu 13.10 or later, then you can install most of the
below-mentioned prerequisites and recommendations by running:::

    $ sudo apt-get update
    $ sudo apt-get install mysql-client mysql-server redis-server \
                           libmysqlclient-dev libxml2-dev libxslt-dev \
                           libjpeg-dev libfreetype6-dev libtiff5-dev \
                           python-software-properties g++ make python-dev \
                           npm git
    $ sudo ln -s /usr/bin/nodejs /usr/bin/node
    $ sudo pip install -U virtualenvwrapper
    $ sudo npm install -g bower grunt-cli

NOTE: The recommended Python version is 2.7.5+

For futher tutorial you will need to check that you have ``git-new-workdir``.::

    which git-new-workdir || { \
        wget https://raw.github.com/git/git/master/contrib/workdir/git-new-workdir \
        -O $HOME/bin/git-new-workdir; chmod +x $HOME/bin/git-new-workdir; }

NOTE: Check that ``~/bin`` is in your ``$PATH``.


Quick instructions for the impatient Invenio admin
--------------------------------------------------

a. Installation
~~~~~~~~~~~~~~~

Run the following commands in your shell::

    $ cd $HOME/src/
    $ export BRANCH=pu
    $ git clone https://github.com/jirikuncar/invenio.git
    $ mkvirtualenv invenio
    (invenio)$ cdvirtualenv
    (invenio)$ mkdir src; cd src
    (invenio)$ git-new-workdir ~/src/invenio/ invenio $BRANCH
    (invenio)$ cd invenio
    (invenio)$ pip install --upgrade pip
    (invenio)$ pip install -e . --process-dependency-links --allow-all-external
    (invenio)$ pybabel compile -fd invenio/base/translations/
    (invenio)$ npm install
    (invenio)$ bower install
    (invenio)$ grunt


b. Configuration
~~~~~~~~~~~~~~~~

Generate the secret key for your installation.::

    (invenio)$ inveniomanage config create secret-key

If you are planning to develop localy in multiple environments please run
following::

    (invenio)$ inveniomanage config set CFG_EMAIL_BACKEND flask.ext.email.backends.console.Mail
    (invenio)$ inveniomanage config set CFG_BIBSCHED_PROCESS_USER `whoami`
    (invenio)$ inveniomanage config set CFG_DATABASE_NAME $BRANCH
    (invenio)$ inveniomanage config set CFG_DATABASE_USER $BRANCH
    (invenio)$ inveniomanage config set CFG_SITE_URL http://0.0.0.0:4000

Invenio comes with default demo site configuration examples that you can use
for quick start.::

    (invenio)$ cd $HOME/src/
    (invenio)$ git clone https://github.com/inveniosoftware/invenio-demosite.git
    (invenio)$ cdvirtualenv src
    (invenio)$ git-new-workdir ~/src/invenio-demosite/ invenio-demosite $BRANCH
    (invenio)$ cd invenio-demosite
    (invenio)$ pip install -e .
    (invenio)$ inveniomanage config set PACKAGES "['invenio_demosite', 'invenio.modules.*']"


c. Development
~~~~~~~~~~~~~~

Once you have everything installed you can create database
and populate it with demo records.::

    (invenio)$ inveniomanage database init --user=root --password=password --yes-i-know
    (invenio)$ inveniomanage database create
    (invenio)$ inveniomanage demosite create

Now you should be able to run the development server. We provide ``Procfile``
that you can run with ``honcho``.::

    (invenio)$ cdvirtualenv src/invenio
    (invenio)$ pip install honcho
    (invenio)$ honcho start

When you have your server running, it is possible to upload demo records.::

    (invenio)$ inveniomanage demosite populate

Optionally, if you are using Bash shell completion, then you may want to
register python argcomplete for inveniomanage.::

    eval "$(register-python-argcomplete inveniomanage)"

Good luck, and thanks for choosing Invenio.

       - Invenio Development Team
         <info@invenio-software.org>
         <http://invenio-software.org/>

.. vim: set ft=rst:
